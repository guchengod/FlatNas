import{d as T,u as V,r as v,E as B,e as o,b as l,m as D,h as r,q as E,F as _,i as p,n as g,f as C,t as f,j as M,G as S,C as j,_ as z}from"./index-0Xhfa8Kb.js";const A=["onClick"],N={class:"text-sm"},W={class:"flex-1 overflow-hidden relative"},$={key:0,class:"p-8 text-center text-white/60 text-xs animate-pulse"},F={key:1,class:"flex flex-col py-1"},I=["href"],L={class:"flex-1 min-w-0"},q={class:"text-sm text-white/80 group-hover/item:text-white transition-colors line-clamp-2 leading-relaxed"},G={key:0,class:"text-xs text-white/50 mt-0.5"},P=60*1e3,U=T({__name:"HotWidget",props:{widget:{}},setup(k){const d=V(),w=v([{id:"weibo",label:"å¾®åš",icon:"ðŸ”¥",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"},{id:"news",label:"ä¸­æ–°ç½‘",icon:"ðŸ—žï¸",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"},{id:"zhihu",label:"çŸ¥ä¹Ž",icon:"ðŸ§ ",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"},{id:"bilibili",label:"Bç«™",icon:"ðŸ“º",activeClass:"text-white bg-white/15",barClass:"bg-white/60",indexClass:"text-white bg-white/15"}]),x=v({}),h=v("weibo"),a=v([]),b=v(!1),m=async(t,i=!1)=>{h.value=t;const e=Date.now();if(!i&&x.value[t]&&e-x.value[t].ts<P){a.value=x.value[t].data;return}b.value=!0,a.value=[];const s=n=>{n.type===t&&(a.value=n.data,x.value[t]={data:a.value,ts:Date.now()},b.value=!1,u())},c=n=>{n.type===t&&(console.error(`åŠ è½½ ${t} å¤±è´¥`,n.error),a.value=[{title:"åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•",url:"#",hot:""}],b.value=!1,u())},u=()=>{d.socket.off("hot:data",s),d.socket.off("hot:error",c)};d.socket.on("hot:data",s),d.socket.on("hot:error",c),d.socket.emit("hot:fetch",{type:t,force:i})};B(()=>{m("weibo")});const y=t=>{const i=t.currentTarget,{scrollTop:e,scrollHeight:s,clientHeight:c}=i,u=t.deltaY,n=e<=0,H=e+c>=s-1;(n&&u<0||H&&u>0)&&(t.preventDefault(),t.stopPropagation())};return(t,i)=>(l(),o("div",{class:"w-full h-full rounded-2xl backdrop-blur border border-white/10 overflow-hidden flex flex-col text-white relative transition-shadow",style:j({backgroundColor:`rgba(0,0,0,${Math.min(.85,Math.max(.15,k.widget.opacity??.35))})`,color:"#fff"})},[D(M(S),{modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=e=>w.value=e),class:"flex border-b border-white/10 bg-white/10 select-none",animation:150},{default:E(()=>[(l(!0),o(_,null,p(w.value,e=>(l(),o("button",{key:e.id,onClick:s=>m(e.id,h.value===e.id),class:g(["flex-1 py-2.5 text-xs font-bold transition-all flex items-center justify-center gap-1.5 relative overflow-hidden cursor-move",h.value===e.id?e.activeClass:"text-white/60 hover:bg-white/10 hover:text-white"])},[r("span",N,f(e.icon),1),r("span",null,f(e.label),1),h.value===e.id?(l(),o("div",{key:0,class:g(["absolute bottom-0 left-0 right-0 h-0.5",e.barClass])},null,2)):C("",!0)],10,A))),128))]),_:1},8,["modelValue"]),r("div",W,[r("div",{class:"h-full overflow-y-auto custom-scrollbar p-0",onWheel:y},[b.value&&a.value.length===0?(l(),o("div",$," åŠ è½½ä¸­... ")):(l(),o("div",F,[(l(!0),o(_,null,p(a.value,(e,s)=>(l(),o("a",{key:s,href:e.url,target:"_blank",class:"block px-3 py-1 hover:bg-white/10 transition-colors group/item flex items-start gap-2"},[r("span",{class:g(["text-xs font-bold min-w-[1.25rem] h-5 flex items-center justify-center rounded mt-0.5 transition-colors",s<3?w.value.find(c=>c.id===h.value)?.indexClass:"text-white/60 bg-white/10"])},f(s+1),3),r("div",L,[r("div",q,f(e.title),1),e.hot?(l(),o("div",G,f(e.hot),1)):C("",!0)])],8,I))),128))]))],32)])],4))}}),J=z(U,[["__scopeId","data-v-837025f1"]]);export{J as default};
